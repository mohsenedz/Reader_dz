
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Dialog Reader - Zwei Stimmen</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        select, button, input {
            margin: 5px 0;
            padding: 8px;
            width: 100%;
        }
        textarea {
            width: 100%;
            height: 150px;
            margin-top: 10px;
            padding: 8px;
        }
    </style>
</head>
<body>

<h2>Dialog Reader - Zwei Stimmen</h2>

<label for="voice1">Wähle Stimme 1 (z.B. Max):</label>
<select id="voice1"></select>

<label for="voice2">Wähle Stimme 2 (z.B. Lisa):</label>
<select id="voice2"></select>

<label for="rate">Geschwindigkeit:</label>
<input type="range" id="rate" min="0.5" max="2" value="1" step="0.1">
<span id="rateValue">1</span>x

<textarea id="text" placeholder="Schreibe hier deinen Dialog..."></textarea>

<br>

<button onclick="startReading()">Start</button>
<button onclick="pauseReading()">Pause</button>
<button onclick="resumeReading()">Fortsetzen</button>

<script>
    const voice1Select = document.getElementById('voice1');
    const voice2Select = document.getElementById('voice2');
    const rateInput = document.getElementById('rate');
    const rateValue = document.getElementById('rateValue');
    const textInput = document.getElementById('text');

    let voices = [];
    let currentUtterance = null;
    let queue = [];
    let paused = false;

    function loadVoices() {
        voices = window.speechSynthesis.getVoices();
        if (voices.length > 0) {
            voice1Select.innerHTML = '';
            voice2Select.innerHTML = '';
            voices.forEach((voice, index) => {
                const option1 = document.createElement('option');
                option1.value = index;
                option1.textContent = `${voice.name} (${voice.lang})`;
                voice1Select.appendChild(option1);

                const option2 = document.createElement('option');
                option2.value = index;
                option2.textContent = `${voice.name} (${voice.lang})`;
                voice2Select.appendChild(option2);
            });
        } else {
            // إذا لم تظهر الأصوات، نحاول مرة أخرى بعد 500 ميلي ثانية
            setTimeout(loadVoices, 500);
        }
    }

    speechSynthesis.onvoiceschanged = loadVoices;
    window.onload = loadVoices;

    rateInput.addEventListener('input', () => {
        rateValue.textContent = rateInput.value;
    });

    function startReading() {
        window.speechSynthesis.cancel();
        const lines = textInput.value.split('\n').filter(line => line.trim() !== '');
        queue = [];

        lines.forEach(line => {
            let utterance = new SpeechSynthesisUtterance(line);
            if (line.startsWith('Max:')) {
                utterance.voice = voices[voice1Select.value];
            } else if (line.startsWith('Lisa:')) {
                utterance.voice = voices[voice2Select.value];
            } else {
                utterance.voice = voices[voice1Select.value];
            }
            utterance.rate = parseFloat(rateInput.value);
            queue.push(utterance);
        });

        speakQueue();
    }

    function speakQueue() {
        if (queue.length === 0) {
            return;
        }
        currentUtterance = queue.shift();
        window.speechSynthesis.speak(currentUtterance);
        currentUtterance.onend = function() {
            if (!paused) {
                speakQueue();
            }
        };
    }

    function pauseReading() {
        paused = true;
        window.speechSynthesis.pause();
    }

    function resumeReading() {
        paused = false;
        window.speechSynthesis.resume();
    }
</script>

</body>
</html>

